---
language: python

env:
  - IMAGE=debian-8-x64

install:
  - go get github.com/digitalocean/doctl/cmd/doctl
  - ~/gopath/bin/doctl auth init
  - echo "Generating ssh key"
  - ssh-keygen -N "" -f my-key
  - echo "Uploading ssh key"
  - ~/gopath/bin/doctl/doctl compute ssh-key import new_key_name --public-key-file ~/.ssh/id_rsa.pub
  - ~/gopath/bin/doctl/doctl compute ssh-key list

script:
  - echo "Creating droplets."
  - ~/gopath/bin/doctl/doctl compute droplet create ${IMAGE} --size 1gb --image ${IMAGE} --region ams3 --ssh-keys 4d:23:e6:e4:8c:17:d2:cf:89:47:36:b5:c7:33:40:4e
  - ~/gopath/bin/doctl/doctl compute droplet list

after_script:
  - echo "Removing ssh key"
  - echo "Remove droplets."

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
  email: false
